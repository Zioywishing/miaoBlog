import{g as e,h as t,j as n,k as r,m as i,o as a,p as o,q as s,r as c,t as l,v as u,w as d}from"./vendor-DGjZBOGL.js";import{c as f}from"./utils-EHw_yAZQ.js";const p={class:`bg-white rounded-lg shadow-xl p-6 pt-0 w-96 max-w-full mx-4 select-none`},m={class:`space-y-3`},h=[`onClick`],g={class:`flex items-center space-x-3`},_={class:`w-5 h-5 text-white`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},v=[`d`],y={class:`text-left`},b={class:`font-medium text-gray-800`},x={class:`text-sm text-gray-500`};var S=i({__name:`saveFile`,emits:[`close`,`saveAsJson`,`saveAsSvg`,`saveAsPng`],setup(n,{emit:i}){let a=i,o=[{title:`保存为 JSON`,description:`保存思维导图数据，可重新导入`,color:`blue`,icon:`M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z`,handler:()=>{a(`saveAsJson`),a(`close`)}},{title:`保存为 SVG`,description:`矢量图格式，可无限缩放`,color:`green`,icon:`M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z`,handler:()=>{a(`saveAsSvg`),a(`close`)}},{title:`保存为 PNG`,description:`位图格式，适合分享和打印`,color:`purple`,icon:`M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z`,handler:()=>{a(`saveAsPng`),a(`close`)}}],l={blue:{button:`bg-blue-50 hover:bg-blue-100 border-blue-200`,iconBg:`bg-blue-500`,arrow:`group-hover:text-blue-500`},green:{button:`bg-green-50 hover:bg-green-100 border-green-200`,iconBg:`bg-green-500`,arrow:`group-hover:text-green-500`},purple:{button:`bg-purple-50 hover:bg-purple-100 border-purple-200`,iconBg:`bg-purple-500`,arrow:`group-hover:text-purple-500`}},f=()=>{a(`close`)};return(n,i)=>(s(),r(`div`,p,[t(`div`,{class:`flex justify-between items-center mb-6`},[i[1]||=t(`h2`,{class:`text-xl font-semibold text-gray-800 select-none`},`保存思维导图`,-1),t(`div`,{onClick:f,class:`text-gray-400 hover:text-gray-600 transition-colors cursor-pointer`,style:{transform:`translateY(4px)`}},i[0]||=[t(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M6 18L18 6M6 6l12 12`})],-1)])]),t(`div`,m,[(s(),r(e,null,c(o,(e,n)=>t(`button`,{key:n,onClick:e.handler,class:u([`w-full flex items-center justify-between p-4 rounded-lg border transition-colors group cursor-pointer`,l[e.color].button])},[t(`div`,g,[t(`div`,{class:u([`w-10 h-10 rounded-lg flex items-center justify-center`,l[e.color].iconBg])},[(s(),r(`svg`,_,[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:e.icon},null,8,v)]))],2),t(`div`,y,[t(`div`,b,d(e.title),1),t(`div`,x,d(e.description),1)])]),(s(),r(`svg`,{class:u([`w-5 h-5 text-gray-400 transition-colors`,l[e.color].arrow]),fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},i[2]||=[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M9 5l7 7-7 7`},null,-1)],2))],10,h)),64))])]))}}),C=S;const w={class:`bg-white rounded-lg shadow-xl p-6 pt-0 w-[500px] max-w-full mx-4 select-none`},T={key:0,class:`mb-4 p-3 bg-red-50 border border-red-200 rounded-lg`},E={class:`text-red-600 text-sm`},D={class:`space-y-4`},O={class:`flex items-center justify-center gap-2`},k=[`onClick`,`disabled`],A={class:`flex items-center space-x-3`},j={class:`text-left`},M={class:`font-medium text-gray-800`},N={class:`text-sm text-gray-500`},P={class:`flex flex-col items-center space-y-2 event-none`};var F=i({__name:`selectFile`,emits:[`close`,`onData`,`onFileHandle`],setup(i,{emit:p}){let m=p,h=f(),g=l(!1),_=l(``),v=l(!1),y=l(``),b=()=>{m(`close`)},x=(e,t)=>{m(`onData`,e),t&&m(`onFileHandle`,t),m(`close`)},S=async()=>{try{v.value=!0,y.value=``;let e=await h({accept:`.json`,multiple:!1});if(e.length>0){let t=e[0],n=await t.text(),r=JSON.parse(n);x(r)}}catch(e){y.value=`文件选择失败或格式错误`,console.error(`File selection error:`,e)}finally{v.value=!1}},C=async()=>{if(!(`showOpenFilePicker`in window)){y.value=`您的浏览器不支持 OPFS API`;return}try{v.value=!0,y.value=``;let[e]=await window.showOpenFilePicker({types:[{description:`JSON files`,accept:{"application/json":[`.json`]}}]});m(`onFileHandle`,e)}catch(e){y.value=`文件选择失败或格式错误`,console.error(`OPFS file selection error:`,e)}finally{v.value=!1}},F=[{title:`选择JSON文件`,description:`从本地选择思维导图文件`,color:`blue`,handler:S},{title:`OPFS选择JSON文件`,description:`仅支持PC，可同步更改`,color:`green`,handler:C}],I=e=>{e.preventDefault(),g.value=!0},L=e=>{e.preventDefault(),g.value=!1},R=async e=>{e.preventDefault(),g.value=!1;try{v.value=!0,y.value=``;let t=e.dataTransfer?.files;if(t&&t.length>0){let e=t[0];if(e.type===`application/json`||e.name.endsWith(`.json`)){let t=await e.text(),n=JSON.parse(t);x(n)}else y.value=`请选择JSON格式的文件`}}catch(e){y.value=`文件解析失败，请确保是有效的JSON格式`,console.error(`Drop error:`,e)}finally{v.value=!1}},z=async e=>{try{let t=e.clipboardData?.getData(`text`);t&&(_.value=t)}catch(e){console.error(`Paste error:`,e)}};return a(()=>{document.addEventListener(`paste`,z)}),o(()=>{document.removeEventListener(`paste`,z)}),(i,a)=>(s(),r(`div`,w,[t(`header`,{class:`flex justify-between items-center my-2`},[a[1]||=t(`h2`,{class:`text-xl font-semibold text-gray-800`},`导入思维导图`,-1),t(`div`,{onClick:b,class:`text-gray-400 hover:text-gray-600 transition-colors cursor-pointer`,style:{transform:`translateY(3px)`}},a[0]||=[t(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M6 18L18 6M6 6l12 12`})],-1)])]),y.value?(s(),r(`div`,T,[t(`p`,E,d(y.value),1)])):n(``,!0),t(`div`,D,[t(`div`,O,[(s(),r(e,null,c(F,(e,n)=>t(`button`,{key:n,onClick:e.handler,disabled:v.value,class:u([`w-full flex flex-1 items-center justify-center p-4 rounded-lg border transition-colors group disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer`,[`bg-${e.color}-50 hover:bg-${e.color}-100 border-${e.color}-200`]])},[t(`div`,A,[t(`div`,{class:u([`w-10 h-10 rounded-lg flex items-center justify-center`,`bg-${e.color}-500`])},a[2]||=[t(`svg`,{class:`w-5 h-5 text-white`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z`})],-1)],2),t(`div`,j,[t(`div`,M,d(e.title),1),t(`div`,N,d(e.description),1)])])],10,k)),64))]),t(`div`,{onDragover:I,onDragleave:L,onDrop:R,class:u([`w-full py-8 border-2 border-dashed rounded-lg transition-colors text-center`,g.value?`border-green-400 bg-green-50`:`border-gray-300 bg-gray-50 hover:bg-gray-100`])},[t(`div`,P,[t(`div`,{class:u([`w-12 h-12 rounded-lg flex items-center justify-center`,g.value?`bg-green-500`:`bg-gray-400`])},a[3]||=[t(`svg`,{class:`w-6 h-6 text-white`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[t(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12`})],-1)],2),t(`div`,null,[t(`p`,{class:u([`font-medium`,g.value?`text-green-700`:`text-gray-700`])},d(g.value?`释放文件以上传`:`拖拽JSON文件到此处`),3),a[4]||=t(`p`,{class:`text-sm text-gray-500`},`支持 .json 格式文件`,-1)])])],34)])]))}}),I=F;export{I as b,C as c};